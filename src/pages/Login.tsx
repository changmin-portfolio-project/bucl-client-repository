import React, { useEffect } from 'react';
import styled from 'styled-components';
import KakaoLoginButton from '../conponents/login/KakaoLoginButton';
import AppleLoginButton from '../conponents/login/AppleLoginButton';
import { postRefreshToken } from '../services';

const LoginPage: React.FC = () => {
  const callbackUrl = new URL(window.location.href).searchParams.get(
    'callbackUrl',
  );

  if (callbackUrl !== null) {
    sessionStorage.setItem('callbackUrl', callbackUrl);
  }

  useEffect(() => {
    postRefreshToken()
      .then((res) => {
        localStorage.setItem('access-token', res.accessToken);
        if (callbackUrl !== null) {
          window.location.href = callbackUrl;
        }
      })
      .catch(() => {});
  }, []);

  return (
    <LoginPageContainer>
      <svg
        width="1783"
        height="389"
        viewBox="0 0 1783 389"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M0 102.053C0 45.6907 45.6907 0 102.053 0H286.181C342.543 0 388.234 45.6907 388.234 102.053V286.181C388.234 342.543 342.543 388.234 286.181 388.234H102.053C45.6907 388.234 0 342.543 0 286.181V102.053Z"
          fill="url(#paint0_linear_545_5457)"
        />
        <path
          d="M312.404 140.024C300.31 128.129 285.016 120.877 268.143 119.025C266.284 102.435 258.929 87.4092 246.835 75.5141C232.79 61.6887 214.097 54.0717 194.21 54.0587H194.157C174.297 54.0587 155.618 61.6496 141.559 75.4489C129.451 87.3309 122.07 102.356 120.185 118.934C103.298 120.76 88.0042 127.985 75.8967 139.868C61.8244 153.667 54.0714 172.031 54.0581 191.569C54.0448 211.107 61.7713 229.472 75.8303 243.297C87.9245 255.205 103.218 262.444 120.092 264.296C121.95 280.887 129.305 295.912 141.399 307.807C155.445 321.633 174.137 329.25 194.024 329.263H194.077C213.938 329.263 232.617 321.672 246.676 307.872C258.783 295.99 266.165 280.978 268.05 264.387C284.937 262.561 300.23 255.336 312.338 243.454C326.41 229.654 334.163 211.29 334.176 191.752C334.176 172.214 326.463 153.849 312.404 140.024ZM302.009 233.306C292.743 242.397 281.087 248.11 268.222 249.897C266.749 232.759 259.155 216.664 246.742 204.443L245.8 203.517L235.471 213.651L236.414 214.577C246.158 224.163 252.225 236.75 253.593 250.171C239.932 248.801 227.134 242.828 217.39 233.241L216.447 232.315L206.119 242.449L207.061 243.375C219.487 255.597 235.856 263.083 253.301 264.544C251.468 277.183 245.64 288.621 236.374 297.712C225.076 308.798 210.061 314.902 194.091 314.902H194.051C178.067 314.902 163.039 308.772 151.754 297.66C142.501 288.556 136.686 277.104 134.868 264.466C152.312 263.018 168.694 255.557 181.134 243.362L182.076 242.436L171.761 232.289L170.818 233.215C161.061 242.789 148.25 248.749 134.589 250.093C135.983 236.671 142.063 224.098 151.821 214.525L152.763 213.599L142.448 203.451L141.505 204.377C129.066 216.572 121.446 232.667 119.959 249.806C107.095 248.006 95.4519 242.28 86.1987 233.176C74.901 222.063 68.688 207.299 68.7013 191.595C68.7013 175.892 74.9409 161.127 86.2518 150.041C95.5183 140.95 107.174 135.237 120.039 133.45C121.512 150.589 129.106 166.684 141.519 178.905L142.461 179.831L152.79 169.696L151.847 168.77C142.103 159.184 136.036 146.598 134.668 133.177C148.329 134.546 161.127 140.52 170.871 150.106L171.814 151.032L182.143 140.898L181.2 139.972C168.787 127.751 152.405 120.264 134.961 118.803C136.793 106.165 142.621 94.7262 151.887 85.6354C163.185 74.549 178.2 68.4449 194.17 68.4449H194.21C210.194 68.4449 225.222 74.575 236.507 85.6875C245.76 94.7914 251.575 106.243 253.393 118.882C235.949 120.329 219.567 127.79 207.127 139.985L206.185 140.911L216.5 151.058L217.443 150.132C227.2 140.559 240.012 134.598 253.672 133.255C252.278 146.676 246.198 159.249 236.44 168.823L235.498 169.749L245.813 179.896L246.756 178.97C259.195 166.775 266.815 150.693 268.302 133.555C281.166 135.355 292.809 141.08 302.062 150.184C313.36 161.297 319.573 176.061 319.56 191.765C319.56 207.469 313.307 222.233 301.996 233.319L302.009 233.306Z"
          fill="white"
        />
        <path
          d="M703.633 187.687C724.447 182.672 741.253 173.457 753.685 160.327C768.668 144.465 776.281 125.015 776.281 102.507C776.281 72.74 763.363 48.9676 737.811 31.8417C713.068 15.2459 677.473 6.8053 631.956 6.8053H468.234V367.795H631.956C677.027 367.795 713.392 359.314 740.038 342.595C767.575 325.306 781.546 301.575 781.546 272.094C781.546 250.523 773.082 231.562 756.317 215.66C742.549 202.611 724.852 193.233 703.592 187.728L703.633 187.687ZM513.224 50.4763H626.165C664.109 50.4763 691.687 55.3287 708.128 64.8702C723.718 73.9225 731.291 87.7864 731.291 107.277C731.291 126.768 723.516 140.958 707.52 150.541C690.715 160.571 663.34 165.668 626.165 165.668H513.224V50.4356V50.4763ZM626.165 323.553H513.224V209.91H626.165C699.786 209.91 737.122 229.034 737.122 266.711C737.122 304.388 699.786 323.512 626.165 323.512V323.553Z"
          fill="#FF8000"
        />
        <path
          d="M1083.75 237.11C1083.75 264.775 1073.83 286.248 1054.27 300.925C1034.19 316.004 1004.68 323.644 966.503 323.644C928.33 323.644 898.002 315.924 877.391 300.644C857.308 285.806 847.145 264.414 847.145 237.11V13.6176H801.979V242.901C801.979 280.136 817.549 310.696 848.242 333.697C878.407 356.336 918.207 367.796 966.503 367.796C1014.8 367.796 1052.48 356.135 1082.65 333.134C1113.34 309.772 1128.91 279.412 1128.91 242.901V13.6176H1083.75V237.11Z"
          fill="#FF8000"
        />
        <path
          d="M1661.05 323.644C1622.55 323.644 1592.63 315.924 1572.04 300.644C1551.98 285.806 1541.83 264.414 1541.83 237.11V13.6176H1496.71V242.901C1496.71 280.136 1512.27 310.696 1542.92 333.697C1573.05 356.336 1612.81 367.796 1661.05 367.796H1782.78V323.644H1661.05Z"
          fill="#FF8000"
        />
        <path
          d="M1436.22 89.7858L1439.12 92.6682L1469.47 62.545L1466.57 59.6627C1432.21 25.5611 1386.53 6.80524 1337.99 6.80524C1289.44 6.80524 1243.76 25.6017 1209.41 59.6627C1175.05 93.7236 1156.16 139.111 1156.16 187.3C1156.16 235.489 1175.09 280.836 1209.41 314.937C1243.72 349.039 1289.44 367.795 1337.99 367.795C1386.53 367.795 1432.21 348.998 1466.57 314.937L1469.47 312.055L1439.12 281.932L1436.22 284.814C1382.07 338.565 1293.94 338.565 1239.75 284.814C1213.5 258.751 1199.06 224.122 1199.06 187.3C1199.06 150.478 1213.5 115.849 1239.75 89.7858C1293.94 36.0352 1382.07 36.0352 1436.22 89.7858Z"
          fill="#FF8000"
        />
        <defs>
          <linearGradient
            id="paint0_linear_545_5457"
            x1="194.117"
            y1="0"
            x2="194.117"
            y2="388.234"
            gradientUnits="userSpaceOnUse"
          >
            <stop stopColor="#FFAD0D" />
            <stop offset="1" stopColor="#FF8000" />
          </linearGradient>
        </defs>
      </svg>
      <LoginBtnBox>
        <KakaoLoginButton />
        <AppleLoginButton />
      </LoginBtnBox>
      <HelpText>
        지금 회원가입 하면 현금처럼 사용 가능한
        <br />
        3,000원 적립금 즉시 지급!
      </HelpText>
    </LoginPageContainer>
  );
};

const LoginPageContainer = styled.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  & > svg:first-child {
    padding: 35vh 0;
    width: 35%;
    height: fit-content;
  }
`;

const LoginBtnBox = styled.div`
  padding: 0 ${({ theme }) => theme.paddings.base};
  width: calc(100% - 14%);
`;

const HelpText = styled.p`
  padding-top: 40px;
  text-align: center;
  font: ${({ theme }) => theme.fontSizes.Body2};
  color: ${({ theme }) => theme.grey.Grey5};
`;

export default LoginPage;
